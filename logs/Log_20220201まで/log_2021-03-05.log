2021-03-05 10:32:51,794 DEBUG [118220] [] Request URI : /eccadmin_dev/Login
2021-03-05 10:32:51,823 DEBUG [118220] [] LoginController start
2021-03-05 10:32:51,823 DEBUG [118220] [] controllers/LoginController.php: is exist
2021-03-05 10:32:51,824 DEBUG [118220] [] LoginForm: is exist
2021-03-05 10:32:51,824 DEBUG [118220] [] LoginForm: form value set 
2021-03-05 10:32:51,825 DEBUG [118220] [] ------------------------------/eccadmin_dev/Login
2021-03-05 10:32:51,825 DEBUG [118220] [] ------------------------------login_start_check
2021-03-05 10:32:51,825 DEBUG [118220] [] indexAction start
2021-03-05 10:32:51,859 DEBUG [118220] [] indexAction end
2021-03-05 10:32:51,859 DEBUG [118220] [] LoginController end
2021-03-05 10:32:51,859 DEBUG [118220] [] finally
2021-03-05 10:32:55,192 DEBUG [118220] [] Request URI : /eccadmin_dev/Login/login
2021-03-05 10:32:55,193 DEBUG [118220] [] LoginController start
2021-03-05 10:32:55,193 DEBUG [118220] [] controllers/LoginController.php: is exist
2021-03-05 10:32:55,193 DEBUG [118220] [] LoginForm: is exist
2021-03-05 10:32:55,193 DEBUG [118220] [] LoginForm: form value set 
2021-03-05 10:32:55,194 DEBUG [118220] [] ------------------------------/eccadmin_dev/Login/login
2021-03-05 10:32:55,194 DEBUG [118220] [] ------------------------------login_start_check
2021-03-05 10:32:55,194 DEBUG [118220] [] loginAction start
2021-03-05 10:32:55,493 DEBUG [118220] [] loginAction end
2021-03-05 10:32:55,493 DEBUG [118220] [] LoginController end
2021-03-05 10:32:55,493 DEBUG [118220] [] finally
2021-03-05 10:32:55,513 DEBUG [118220] [] Request URI : /eccadmin_dev/Menu
2021-03-05 10:32:55,513 DEBUG [118220] [] MenuController start
2021-03-05 10:32:55,513 DEBUG [118220] [] controllers/MenuController.php: is exist
2021-03-05 10:32:55,514 DEBUG [118220] [] MenuForm: is exist
2021-03-05 10:32:55,514 DEBUG [118220] [] MenuForm: form value set 
2021-03-05 10:32:55,514 DEBUG [118220] [] ------------------------------/eccadmin_dev/Menu
2021-03-05 10:32:55,514 DEBUG [118220] [] ------------------------------login_start_check
2021-03-05 10:32:55,514 DEBUG [118220] [] indexAction start
2021-03-05 10:32:55,514 DEBUG [118220] [] admin_no is 1
2021-03-05 10:32:55,563 DEBUG [118220] [] indexAction end
2021-03-05 10:32:55,563 DEBUG [118220] [] MenuController end
2021-03-05 10:32:55,563 DEBUG [118220] [] finally
2021-03-05 10:33:02,300 DEBUG [118036] [] Request URI : /eccadmin_dev/CourseContractConfirmList
2021-03-05 10:33:02,301 DEBUG [118036] [] CourseContractConfirmListController start
2021-03-05 10:33:02,301 DEBUG [118036] [] controllers/CourseContractConfirmListController.php: is exist
2021-03-05 10:33:02,301 DEBUG [118036] [] CourseContractConfirmListForm: is exist
2021-03-05 10:33:02,301 DEBUG [118036] [] CourseContractConfirmListForm: form value set 
2021-03-05 10:33:02,302 DEBUG [118036] [] ------------------------------/eccadmin_dev/CourseContractConfirmList
2021-03-05 10:33:02,302 DEBUG [118036] [] indexAction start
2021-03-05 10:33:02,302 DEBUG [118036] [] admin_no is 1
2021-03-05 10:33:02,388 DEBUG [118036] [] indexAction end
2021-03-05 10:33:02,388 DEBUG [118036] [] CourseContractConfirmListController end
2021-03-05 10:33:02,388 DEBUG [118036] [] finally
2021-03-05 10:33:10,775 DEBUG [118421] [] Request URI : /eccadmin_dev/CourseContractConfirmList/Search
2021-03-05 10:33:10,779 DEBUG [118421] [] CourseContractConfirmListController start
2021-03-05 10:33:10,779 DEBUG [118421] [] controllers/CourseContractConfirmListController.php: is exist
2021-03-05 10:33:10,780 DEBUG [118421] [] CourseContractConfirmListForm: is exist
2021-03-05 10:33:10,780 DEBUG [118421] [] CourseContractConfirmListForm: form value set 
2021-03-05 10:33:10,781 DEBUG [118421] [] ------------------------------/eccadmin_dev/CourseContractConfirmList/Search
2021-03-05 10:33:10,781 DEBUG [118421] [] SearchAction start
2021-03-05 10:33:10,781 DEBUG [118421] [] admin_no is 1
2021-03-05 10:33:10,784 DEBUG [118421] [] CourseContractConfirmList　Query
2021-03-05 10:33:10,784 DEBUG [118421] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id
2021-03-05 10:33:10,894 DEBUG [118421] [] CourseContractConfirmList　Query
2021-03-05 10:33:10,894 DEBUG [118421] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id LIMIT 0 , 10
2021-03-05 10:33:11,082 DEBUG [118421] [] SearchAction end
2021-03-05 10:33:11,082 DEBUG [118421] [] CourseContractConfirmListController end
2021-03-05 10:33:11,082 DEBUG [118421] [] finally
2021-03-05 10:33:15,014 DEBUG [118421] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 10:33:15,014 DEBUG [118421] [] StudentCourseDetailEditController start
2021-03-05 10:33:15,014 DEBUG [118421] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 10:33:15,015 DEBUG [118421] [] StudentCourseDetailEditForm: is exist
2021-03-05 10:33:15,015 DEBUG [118421] [] StudentCourseDetailEditForm: form value set 
2021-03-05 10:33:15,016 DEBUG [118421] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 10:33:15,016 DEBUG [118421] [] ------------------------------session_check_true
2021-03-05 10:33:15,016 DEBUG [118421] [] indexAction start
2021-03-05 10:33:15,016 DEBUG [118421] [] admin_no is 1
2021-03-05 10:33:15,018 DEBUG [118421] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 10:33:15,312 DEBUG [118421] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 10:33:15,620 DEBUG [118421] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 10:33:15,984 DEBUG [118421] [] indexAction end
2021-03-05 10:33:15,984 DEBUG [118421] [] StudentCourseDetailEditController end
2021-03-05 10:33:15,985 DEBUG [118421] [] finally
2021-03-05 10:33:21,918 DEBUG [118418] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/retake
2021-03-05 10:33:21,922 DEBUG [118418] [] StudentCourseDetailEditController start
2021-03-05 10:33:21,922 DEBUG [118418] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 10:33:21,923 DEBUG [118418] [] StudentCourseDetailEditForm: is exist
2021-03-05 10:33:21,923 DEBUG [118418] [] StudentCourseDetailEditForm: form value set 
2021-03-05 10:33:21,924 DEBUG [118418] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/retake
2021-03-05 10:33:21,924 DEBUG [118418] [] ------------------------------session_check_true
2021-03-05 10:33:21,924 DEBUG [118418] [] retakeAction start
2021-03-05 10:33:21,924 DEBUG [118418] [] admin_no is 1
2021-03-05 10:33:21,928 DEBUG [118418] [] 再受講設定しました。
2021-03-05 10:33:21,928 DEBUG [118418] [] ユーザーの組織 :1
2021-03-05 10:33:21,928 DEBUG [118418] [] 受講者No :1
2021-03-05 10:33:21,928 DEBUG [118418] [] Offer No :244
2021-03-05 10:33:21,928 DEBUG [118418] [] コース名 :8
2021-03-05 10:33:21,928 DEBUG [118418] [] コース詳細名 :8
2021-03-05 10:33:21,929 DEBUG [118418] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 10:33:22,213 DEBUG [118418] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 10:33:22,506 DEBUG [118418] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 10:33:22,820 DEBUG [118418] [] retakeAction end
2021-03-05 10:33:22,820 DEBUG [118418] [] StudentCourseDetailEditController end
2021-03-05 10:33:22,820 DEBUG [118418] [] finally
2021-03-05 11:06:24,705 DEBUG [120349] [] Request URI : /eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:06:24,706 DEBUG [120349] [] CourseContractConfirmListController start
2021-03-05 11:06:24,706 DEBUG [120349] [] controllers/CourseContractConfirmListController.php: is exist
2021-03-05 11:06:24,706 DEBUG [120349] [] CourseContractConfirmListForm: is exist
2021-03-05 11:06:24,706 DEBUG [120349] [] CourseContractConfirmListForm: form value set 
2021-03-05 11:06:24,707 DEBUG [120349] [] ------------------------------/eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:06:24,707 DEBUG [120349] [] searchAction start
2021-03-05 11:06:24,707 DEBUG [120349] [] admin_no is 1
2021-03-05 11:06:24,710 DEBUG [120349] [] CourseContractConfirmList　Query
2021-03-05 11:06:24,710 DEBUG [120349] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id
2021-03-05 11:06:24,823 DEBUG [120349] [] CourseContractConfirmList　Query
2021-03-05 11:06:24,823 DEBUG [120349] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id LIMIT 0 , 10
2021-03-05 11:06:25,030 DEBUG [120349] [] searchAction end
2021-03-05 11:06:25,030 DEBUG [120349] [] CourseContractConfirmListController end
2021-03-05 11:06:25,030 DEBUG [120349] [] finally
2021-03-05 11:06:26,951 DEBUG [120349] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:06:26,952 DEBUG [120349] [] StudentCourseDetailEditController start
2021-03-05 11:06:26,952 DEBUG [120349] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 11:06:26,952 DEBUG [120349] [] StudentCourseDetailEditForm: is exist
2021-03-05 11:06:26,953 DEBUG [120349] [] StudentCourseDetailEditForm: form value set 
2021-03-05 11:06:26,953 DEBUG [120349] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:06:26,953 DEBUG [120349] [] ------------------------------session_check_true
2021-03-05 11:06:26,953 DEBUG [120349] [] indexAction start
2021-03-05 11:06:26,954 DEBUG [120349] [] admin_no is 1
2021-03-05 11:06:26,955 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:06:27,259 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:06:27,555 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:06:27,922 DEBUG [120349] [] indexAction end
2021-03-05 11:06:27,922 DEBUG [120349] [] StudentCourseDetailEditController end
2021-03-05 11:06:27,922 DEBUG [120349] [] finally
2021-03-05 11:06:30,305 DEBUG [120349] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/retake
2021-03-05 11:06:30,306 DEBUG [120349] [] StudentCourseDetailEditController start
2021-03-05 11:06:30,306 DEBUG [120349] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 11:06:30,306 DEBUG [120349] [] StudentCourseDetailEditForm: is exist
2021-03-05 11:06:30,306 DEBUG [120349] [] StudentCourseDetailEditForm: form value set 
2021-03-05 11:06:30,307 DEBUG [120349] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/retake
2021-03-05 11:06:30,307 DEBUG [120349] [] ------------------------------session_check_true
2021-03-05 11:06:30,307 DEBUG [120349] [] retakeAction start
2021-03-05 11:06:30,307 DEBUG [120349] [] admin_no is 1
2021-03-05 11:06:30,312 DEBUG [120349] [] 再受講設定しました。
2021-03-05 11:06:30,312 DEBUG [120349] [] ユーザーの組織 :1
2021-03-05 11:06:30,313 DEBUG [120349] [] 受講者No :1
2021-03-05 11:06:30,313 DEBUG [120349] [] Offer No :244
2021-03-05 11:06:30,313 DEBUG [120349] [] コース名 :8
2021-03-05 11:06:30,313 DEBUG [120349] [] コース詳細名 :8
2021-03-05 11:06:30,314 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:06:30,608 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:06:30,882 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:06:31,249 DEBUG [120349] [] retakeAction end
2021-03-05 11:06:31,249 DEBUG [120349] [] StudentCourseDetailEditController end
2021-03-05 11:06:31,249 DEBUG [120349] [] finally
2021-03-05 11:10:06,416 DEBUG [120349] [] Request URI : /eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:10:06,417 DEBUG [120349] [] CourseContractConfirmListController start
2021-03-05 11:10:06,417 DEBUG [120349] [] controllers/CourseContractConfirmListController.php: is exist
2021-03-05 11:10:06,417 DEBUG [120349] [] CourseContractConfirmListForm: is exist
2021-03-05 11:10:06,417 DEBUG [120349] [] CourseContractConfirmListForm: form value set 
2021-03-05 11:10:06,418 DEBUG [120349] [] ------------------------------/eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:10:06,418 DEBUG [120349] [] searchAction start
2021-03-05 11:10:06,418 DEBUG [120349] [] admin_no is 1
2021-03-05 11:10:06,421 DEBUG [120349] [] CourseContractConfirmList　Query
2021-03-05 11:10:06,421 DEBUG [120349] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id
2021-03-05 11:10:06,528 DEBUG [120349] [] CourseContractConfirmList　Query
2021-03-05 11:10:06,528 DEBUG [120349] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id LIMIT 0 , 10
2021-03-05 11:10:06,680 DEBUG [120349] [] searchAction end
2021-03-05 11:10:06,680 DEBUG [120349] [] CourseContractConfirmListController end
2021-03-05 11:10:06,680 DEBUG [120349] [] finally
2021-03-05 11:10:08,056 DEBUG [120349] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:10:08,056 DEBUG [120349] [] StudentCourseDetailEditController start
2021-03-05 11:10:08,056 DEBUG [120349] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 11:10:08,057 DEBUG [120349] [] StudentCourseDetailEditForm: is exist
2021-03-05 11:10:08,057 DEBUG [120349] [] StudentCourseDetailEditForm: form value set 
2021-03-05 11:10:08,057 DEBUG [120349] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:10:08,057 DEBUG [120349] [] ------------------------------session_check_true
2021-03-05 11:10:08,058 DEBUG [120349] [] indexAction start
2021-03-05 11:10:08,058 DEBUG [120349] [] admin_no is 1
2021-03-05 11:10:08,059 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:10:08,339 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:10:08,624 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:10:08,986 DEBUG [120349] [] indexAction end
2021-03-05 11:10:08,987 DEBUG [120349] [] StudentCourseDetailEditController end
2021-03-05 11:10:08,987 DEBUG [120349] [] finally
2021-03-05 11:10:13,535 DEBUG [120349] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/retake
2021-03-05 11:10:13,536 DEBUG [120349] [] StudentCourseDetailEditController start
2021-03-05 11:10:13,536 DEBUG [120349] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 11:10:13,536 DEBUG [120349] [] StudentCourseDetailEditForm: is exist
2021-03-05 11:10:13,536 DEBUG [120349] [] StudentCourseDetailEditForm: form value set 
2021-03-05 11:10:13,537 DEBUG [120349] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/retake
2021-03-05 11:10:13,537 DEBUG [120349] [] ------------------------------session_check_true
2021-03-05 11:10:13,537 DEBUG [120349] [] retakeAction start
2021-03-05 11:10:13,537 DEBUG [120349] [] admin_no is 1
2021-03-05 11:10:13,543 DEBUG [120349] [] 再受講設定しました。
2021-03-05 11:10:13,543 DEBUG [120349] [] ユーザーの組織 :1
2021-03-05 11:10:13,543 DEBUG [120349] [] 受講者No :1
2021-03-05 11:10:13,543 DEBUG [120349] [] Offer No :244
2021-03-05 11:10:13,543 DEBUG [120349] [] コース名 :8
2021-03-05 11:10:13,543 DEBUG [120349] [] コース詳細名 :8
2021-03-05 11:10:13,545 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:10:13,833 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:10:14,074 DEBUG [120349] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:10:14,440 DEBUG [120349] [] retakeAction end
2021-03-05 11:10:14,440 DEBUG [120349] [] StudentCourseDetailEditController end
2021-03-05 11:10:14,440 DEBUG [120349] [] finally
2021-03-05 11:15:33,252 DEBUG [120877] [] Request URI : /eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:15:33,253 DEBUG [120877] [] CourseContractConfirmListController start
2021-03-05 11:15:33,253 DEBUG [120877] [] controllers/CourseContractConfirmListController.php: is exist
2021-03-05 11:15:33,253 DEBUG [120877] [] CourseContractConfirmListForm: is exist
2021-03-05 11:15:33,254 DEBUG [120877] [] CourseContractConfirmListForm: form value set 
2021-03-05 11:15:33,254 DEBUG [120877] [] ------------------------------/eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:15:33,254 DEBUG [120877] [] searchAction start
2021-03-05 11:15:33,255 DEBUG [120877] [] admin_no is 1
2021-03-05 11:15:33,258 DEBUG [120877] [] CourseContractConfirmList　Query
2021-03-05 11:15:33,258 DEBUG [120877] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id
2021-03-05 11:15:33,369 DEBUG [120877] [] CourseContractConfirmList　Query
2021-03-05 11:15:33,369 DEBUG [120877] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id LIMIT 0 , 10
2021-03-05 11:15:33,567 DEBUG [120877] [] searchAction end
2021-03-05 11:15:33,567 DEBUG [120877] [] CourseContractConfirmListController end
2021-03-05 11:15:33,567 DEBUG [120877] [] finally
2021-03-05 11:15:35,562 DEBUG [120877] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:15:35,562 DEBUG [120877] [] StudentCourseDetailEditController start
2021-03-05 11:15:35,562 DEBUG [120877] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 11:15:35,563 DEBUG [120877] [] StudentCourseDetailEditForm: is exist
2021-03-05 11:15:35,563 DEBUG [120877] [] StudentCourseDetailEditForm: form value set 
2021-03-05 11:15:35,564 DEBUG [120877] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:15:35,564 DEBUG [120877] [] ------------------------------session_check_true
2021-03-05 11:15:35,564 DEBUG [120877] [] indexAction start
2021-03-05 11:15:35,564 DEBUG [120877] [] admin_no is 1
2021-03-05 11:15:35,565 DEBUG [120877] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:15:35,853 DEBUG [120877] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:15:36,137 DEBUG [120877] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:15:36,467 DEBUG [120877] [] indexAction end
2021-03-05 11:15:36,467 DEBUG [120877] [] StudentCourseDetailEditController end
2021-03-05 11:15:36,467 DEBUG [120877] [] finally
2021-03-05 11:15:44,933 DEBUG [119915] [] Request URI : /eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:15:44,934 DEBUG [119915] [] CourseContractConfirmListController start
2021-03-05 11:15:44,934 DEBUG [119915] [] controllers/CourseContractConfirmListController.php: is exist
2021-03-05 11:15:44,935 DEBUG [119915] [] CourseContractConfirmListForm: is exist
2021-03-05 11:15:44,935 DEBUG [119915] [] CourseContractConfirmListForm: form value set 
2021-03-05 11:15:44,935 DEBUG [119915] [] ------------------------------/eccadmin_dev/CourseContractConfirmList/search
2021-03-05 11:15:44,935 DEBUG [119915] [] searchAction start
2021-03-05 11:15:44,936 DEBUG [119915] [] admin_no is 1
2021-03-05 11:15:44,939 DEBUG [119915] [] CourseContractConfirmList　Query
2021-03-05 11:15:44,939 DEBUG [119915] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id
2021-03-05 11:15:45,045 DEBUG [119915] [] CourseContractConfirmList　Query
2021-03-05 11:15:45,045 DEBUG [119915] []  SELECT   o.org_no    ,o.org_id  ,o.org_name  ,o.org_name_official  ,c.course_id  ,c.course_name  ,date_format(co.start_period,'%Y/%m/%d') AS  co_start_period ,date_format(co.end_period,'%Y/%m/%d') AS  co_end_period ,co.remarks  ,co.offer_no  ,d.course_detail_no  ,d.course_detail_name  ,s.student_no  ,s.student_name  ,s.login_id  ,date_format(cds.start_period,'%Y/%m/%d') AS cds_start_period  ,date_format(cds.end_period,'%Y/%m/%d') AS cds_end_period  ,date_format(answer.answer_dt,'%Y/%m/%d') AS a_answer_dt  ,date_format(r.update_dt,'%Y/%m/%d') AS u_update_dt  ,teacher.display_name AS display_name  ,teacher.login_id AS teacher_code ,teacher.name AS teacher_name ,teacher.school_kbn AS teacher_school   ,CONCAT(if (student_mark.result_marks IS NULL,'-', student_mark.result_marks ),'/',total_mark.marks) AS result  FROM M_ORGANIZATION o  INNER JOIN T_COURSE_ORG as co  ON co.org_no = o.org_no  AND co.del_flg = '0'  AND o.del_flg = '0'  INNER JOIN T_COURSE as c  ON c.course_id = co.course_id  AND c.del_flg = '0'  INNER JOIN T_COURSE_DETAIL as cd  ON cd.course_id = c.course_id  AND cd.del_flg = '0'  INNER JOIN T_DETAIL as d  ON d.course_detail_no = cd.course_detail_no  AND c.course_level = d.course_level  AND c.test_kbn = d.test_kbn  AND d.del_flg = '0'  LEFT JOIN T_COURSE_DETAIL_STUDENT as cds  ON cds.offer_no = co.offer_no  AND cds.course_id = c.course_id  AND cds.course_detail_no = cd.course_detail_no  AND cds.del_flg = '0'  LEFT JOIN T_STUDENT as s  ON s.org_no = co.org_no  AND s.student_no = cds.student_no  AND s.del_flg = '0'  LEFT JOIN T_4SKILL_RESULT as r  ON r.offer_no = co.offer_no  AND r.course_id = c.course_id  AND r.course_detail_no = cd.course_detail_no  AND r.student_no = cds.student_no  AND r.del_flg = '0'  LEFT JOIN ( SELECT teacher_no,  del_flg, display_name, login_id, name, CASE WHEN school_kbn = '001' THEN 'Philippines'  WHEN school_kbn = '002' THEN 'Japan' ELSE NULL END AS school_kbn  FROM T_TEACHER) teacher  ON r.updater_id = teacher.teacher_no  AND teacher.del_flg = '0'  LEFT JOIN (  SELECT offer_no  	,course_id course_id  	,course_detail_no course_detail_no  	,student_no  	,MIN(answer_dt) answer_dt  	FROM T_4SKILL_ANSWER  	WHERE del_flg = '0'   	GROUP BY offer_no,course_id,course_detail_no,student_no ) answer  ON c.course_id = answer.course_id  AND cd.course_detail_no = answer.course_detail_no  AND co.offer_no = answer.offer_no  AND s.student_no = answer.student_no  LEFT JOIN (  	SELECT a.offer_no ,a.student_no,a.course_id,a.course_detail_no,SUM(a.marks) as result_marks  	FROM (  		SELECT skill_answer.offer_no  		,skill_answer.student_no  		,skill_answer.course_id  		,skill_answer.course_detail_no  		,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no  		,skill_result_detail.rule_detail_no  		,mark_detail.marks  		FROM T_4SKILL_ANSWER skill_answer  		LEFT JOIN T_4SKILL_RESULT skill_result  		ON skill_answer.offer_no = skill_result.offer_no  		AND skill_answer.student_no = skill_result.student_no  		AND skill_answer.course_id = skill_result.course_id  		AND skill_answer.course_detail_no = skill_result.course_detail_no  		INNER JOIN T_4SKILL_RESULT_DETAIL skill_result_detail  		ON skill_result.result_no = skill_result_detail.result_no  		INNER JOIN M_MARK_DETAIL mark_detail  		ON skill_result_detail.rule_no = mark_detail.rule_no  		AND skill_result_detail.sub_rule_no = mark_detail.sub_rule_no  		AND skill_result_detail.rule_detail_no = mark_detail.rule_detail_no  		AND skill_answer.del_flg = '0'  		AND skill_result.del_flg = '0'  		GROUP BY skill_answer.offer_no ,skill_answer.student_no ,skill_answer.course_id,mark_detail.marks  		,skill_answer.course_detail_no ,skill_result_detail.rule_no  		,skill_result_detail.sub_rule_no ,skill_result_detail.rule_detail_no  	) as a  	GROUP BY a.offer_no  ,a.student_no  ,a.course_id  ,a.course_detail_no  ) as student_mark  ON s.student_no = student_mark.student_no  AND co.offer_no = student_mark.offer_no  AND co.course_id = student_mark.course_id  AND cd.course_detail_no = student_mark.course_detail_no  LEFT JOIN  (  	SELECT mark_rule.course_level  	, mark_rule.test_kbn  	, course.course_id  	, course_detail.course_detail_no  	, SUM(mark_detail.max_marks) marks  	FROM T_COURSE course  	INNER JOIN T_COURSE_DETAIL course_detail  	ON course.course_id = course_detail.course_id  	AND course.del_flg = '0'  	AND course_detail.del_flg = '0'  	INNER JOIN T_COURSE_DETAIL_QUESTION course_detail_qa  	ON course_detail.course_detail_no = course_detail_qa.course_detail_no  	AND course_detail_qa.del_flg = '0'  	INNER JOIN T_QUESTION ques  	ON course_detail_qa.question_no = ques.question_no  	AND ques.del_flg = '0'  	INNER JOIN  M_MARK_RULE mark_rule  	ON ques.score_pattern = mark_rule.score_pattern  	AND course.course_level = mark_rule.course_level  	AND course.test_kbn = mark_rule.test_kbn  	INNER JOIN  (  		SELECT  rule_no  			,SUM(max_marks) AS max_marks  			FROM (  				SELECT rule_no  				,sub_rule_no  				,MAX(marks) AS max_marks  				FROM M_MARK_DETAIL  				WHERE del_flg = '0'  				GROUP BY rule_no,sub_rule_no) AS max  			GROUP BY rule_no  		) mark_detail  	ON mark_rule.rule_no = mark_detail.rule_no  	GROUP BY mark_rule.course_level      ,mark_rule.test_kbn, course.course_id, course_detail.course_detail_no  ) as total_mark  ON c.course_id = total_mark.course_id  AND cd.course_detail_no = total_mark.course_detail_no  AND c.course_level =  total_mark.course_level  AND c.test_kbn =  total_mark.test_kbn  WHERE  '1' = '1'  AND c.course_id = :course_id_from  AND co.end_period >= :start_period  AND co.start_period <= :end_period  AND s.login_id = :login_id_from  GROUP BY o.org_no,o.org_id,o.org_name,o.org_name_official,c.course_id,c.course_name,co_start_period,co_end_period,co.remarks,co.offer_no, d.course_detail_no, d.course_detail_name,s.student_no,s.student_name,s.login_id,cds_start_period,cds_end_period,a_answer_dt,u_update_dt,display_name,teacher.login_id,teacher_name,teacher.school_kbn ORDER BY o.org_no,co.offer_no, c.course_id, cd.disp_no, cds.course_detail_no,s.login_id LIMIT 0 , 10
2021-03-05 11:15:45,203 DEBUG [119915] [] searchAction end
2021-03-05 11:15:45,203 DEBUG [119915] [] CourseContractConfirmListController end
2021-03-05 11:15:45,203 DEBUG [119915] [] finally
2021-03-05 11:15:50,418 DEBUG [120711] [] Request URI : /eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:15:50,418 DEBUG [120711] [] StudentCourseDetailEditController start
2021-03-05 11:15:50,418 DEBUG [120711] [] controllers/StudentCourseDetailEditController.php: is exist
2021-03-05 11:15:50,419 DEBUG [120711] [] StudentCourseDetailEditForm: is exist
2021-03-05 11:15:50,419 DEBUG [120711] [] StudentCourseDetailEditForm: form value set 
2021-03-05 11:15:50,420 DEBUG [120711] [] ------------------------------/eccadmin_dev/StudentCourseDetailEdit/index
2021-03-05 11:15:50,420 DEBUG [120711] [] ------------------------------session_check_true
2021-03-05 11:15:50,420 DEBUG [120711] [] indexAction start
2021-03-05 11:15:50,420 DEBUG [120711] [] admin_no is 1
2021-03-05 11:15:50,422 DEBUG [120711] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:15:50,714 DEBUG [120711] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:15:50,996 DEBUG [120711] []  SELECT DISTINCT m_org.org_no  ,m_org.org_id  ,m_org.org_name  ,m_org.org_name_official  ,course.course_id  ,course.course_name  ,course.remarks  ,detail.course_detail_name  ,detail.course_detail_romaji  ,detail.course_detail_no  ,course_detail.disp_no  ,detail.status  ,(SELECT name FROM M_TYPE a WHERE category=:course_level AND a.type=detail.course_level) AS course_level  ,(SELECT name FROM M_TYPE a WHERE category=:test_kbn AND a.type=detail.test_kbn) AS test_kbn  ,date_format(course_org.start_period,'%Y/%m/%d') AS start_period  ,date_format(course_org.end_period,'%Y/%m/%d') AS end_period  ,student.student_no  ,student.student_name  ,student.student_name_romaji  ,student.login_id  ,date_format(detail_student.start_period,'%Y/%m/%d') AS stu_course_start_period ,date_format(detail_student.end_period,'%Y/%m/%d') AS stu_course_end_period ,date_format(skill_answer.answer_dt,'%Y/%m/%d') AS answer_dt  ,date_format(skill_result.update_dt,'%Y/%m/%d') AS update_dt FROM T_COURSE course  LEFT JOIN T_COURSE_ORG as course_org  ON course_org.course_id = course.course_id  LEFT JOIN M_ORGANIZATION as m_org  ON course_org.org_no = m_org.org_no  LEFT JOIN T_COURSE_DETAIL as course_detail   ON course.course_id = course_detail.course_id   LEFT JOIN T_DETAIL as detail  ON course_detail.course_detail_no = detail.course_detail_no  LEFT JOIN T_COURSE_DETAIL_STUDENT as detail_student  ON detail_student.offer_no = course_org.offer_no  AND detail_student.org_no = m_org.org_no  AND detail_student.course_id = course.course_id  AND detail_student.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_STUDENT as student ON detail_student.student_no = student.student_no  AND m_org.org_no = student.org_no LEFT JOIN (  SELECT answer.offer_no offer_no  ,answer.course_id course_id  ,answer.course_detail_no course_detail_no  ,answer.student_no student_no  ,MIN(answer.answer_dt) answer_dt  FROM T_COURSE_DETAIL_QUESTION cdques   LEFT JOIN T_4SKILL_ANSWER as answer ON answer.course_detail_no = cdques.course_detail_no  AND answer.question_no = cdques.question_no  AND answer.del_flg = 0  AND cdques.del_flg = 0  GROUP BY offer_no ,course_id ,course_detail_no, student_no ) skill_answer  ON skill_answer.offer_no = course_org.offer_no  AND skill_answer.student_no = student.student_no  AND skill_answer.course_id = course.course_id  AND skill_answer.course_detail_no = course_detail.course_detail_no  LEFT JOIN T_4SKILL_RESULT as skill_result ON skill_result.offer_no = course_org.offer_no  AND skill_result.student_no = student.student_no  AND skill_result.course_id = course.course_id  AND skill_result.course_detail_no = course_detail.course_detail_no  AND skill_result.del_flg = 0  WHERE course.course_id = :course_id  AND course_detail.course_detail_no = :course_detail_no  AND student.student_no = :student_no  AND m_org.org_no = :org_no  AND course_org.offer_no = :offer_no  AND course.del_flg = '0'  AND course_detail.del_flg = '0'  AND detail.del_flg = '0'  AND detail_student.del_flg = '0'  AND m_org.del_flg = '0'  GROUP BY  org_no,org_id, org_name,org_name_official,course_id,course_name,remarks,course_detail_name,course_detail_romaji,course_detail_no,disp_no,status,course_level,test_kbn,start_period,end_period,student_no,student_name,login_id,stu_course_end_period,stu_course_start_period,answer_dt,update_dt ORDER BY  course_detail.disp_no ASC 
2021-03-05 11:15:51,360 DEBUG [120711] [] indexAction end
2021-03-05 11:15:51,360 DEBUG [120711] [] StudentCourseDetailEditController end
2021-03-05 11:15:51,361 DEBUG [120711] [] finally
2021-03-05 11:33:19,263 DEBUG [121320] [] Request URI : /eccadmin_dev/Login/logout
2021-03-05 11:33:19,263 DEBUG [121320] [] LoginController start
2021-03-05 11:33:19,264 DEBUG [121320] [] controllers/LoginController.php: is exist
2021-03-05 11:33:19,264 DEBUG [121320] [] LoginForm: is exist
2021-03-05 11:33:19,264 DEBUG [121320] [] LoginForm: form value set 
2021-03-05 11:33:19,265 DEBUG [121320] [] ------------------------------/eccadmin_dev/Login/logout
2021-03-05 11:33:19,265 DEBUG [121320] [] ------------------------------login_start_check
2021-03-05 11:33:19,265 DEBUG [121320] [] logoutAction start
2021-03-05 11:33:19,265 DEBUG [121320] [] logoutAction end
2021-03-05 11:33:19,265 DEBUG [121320] [] LoginController end
2021-03-05 11:33:19,265 DEBUG [121320] [] finally
2021-03-05 11:33:19,315 DEBUG [121320] [] Request URI : /eccadmin_dev/Login
2021-03-05 11:33:19,315 DEBUG [121320] [] LoginController start
2021-03-05 11:33:19,315 DEBUG [121320] [] controllers/LoginController.php: is exist
2021-03-05 11:33:19,315 DEBUG [121320] [] LoginForm: is exist
2021-03-05 11:33:19,315 DEBUG [121320] [] LoginForm: form value set 
2021-03-05 11:33:19,316 DEBUG [121320] [] ------------------------------/eccadmin_dev/Login
2021-03-05 11:33:19,316 DEBUG [121320] [] ------------------------------login_start_check
2021-03-05 11:33:19,316 DEBUG [121320] [] indexAction start
2021-03-05 11:33:19,331 DEBUG [121320] [] indexAction end
2021-03-05 11:33:19,331 DEBUG [121320] [] LoginController end
2021-03-05 11:33:19,332 DEBUG [121320] [] finally
